# HighPer Realtime Library Configuration
# Copy this file to .env and adjust values as needed

# =============================================================================
# GLOBAL REALTIME CONFIGURATION
# =============================================================================

# Enable realtime services (must be true to use any protocol)
REALTIME_ENABLED=false

# Auto-start realtime server when service provider loads
REALTIME_AUTO_START=true

# Auto-register default realtime routes
REALTIME_AUTO_REGISTER_ROUTES=true

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Server binding configuration
REALTIME_HOST=0.0.0.0
REALTIME_PORT=8080

# Connection limits and timeouts
REALTIME_MAX_CONNECTIONS=10000
REALTIME_CONNECTION_TIMEOUT=300
REALTIME_HEARTBEAT_INTERVAL=30
REALTIME_BUFFER_SIZE=8192

# =============================================================================
# WEBSOCKET PROTOCOL CONFIGURATION
# =============================================================================

# Enable WebSocket protocol
WEBSOCKET_ENABLED=false

# WebSocket endpoint path
WEBSOCKET_PATH=/ws

# WebSocket frame and message size limits (bytes)
WEBSOCKET_MAX_FRAME_SIZE=2097152
WEBSOCKET_MAX_MESSAGE_SIZE=10485760

# WebSocket compression and validation
WEBSOCKET_COMPRESSION=true
WEBSOCKET_VALIDATE_UTF8=true

# WebSocket heartbeat configuration
WEBSOCKET_HEARTBEAT_ENABLED=true
WEBSOCKET_HEARTBEAT_INTERVAL=30
WEBSOCKET_HEARTBEAT_TIMEOUT=10

# =============================================================================
# SERVER-SENT EVENTS (SSE) CONFIGURATION
# =============================================================================

# Enable SSE protocol
SSE_ENABLED=false

# SSE endpoint path
SSE_PATH=/sse

# SSE timing configuration (milliseconds)
SSE_RETRY_INTERVAL=3000
SSE_KEEP_ALIVE_INTERVAL=25

# SSE event size limit (bytes)
SSE_MAX_EVENT_SIZE=65536

# SSE CORS configuration
SSE_CORS_ENABLED=true
SSE_CORS_ORIGINS=*

# =============================================================================
# WEBTRANSPORT PROTOCOL CONFIGURATION
# =============================================================================

# Enable WebTransport protocol (requires HTTP/3)
WEBTRANSPORT_ENABLED=false

# WebTransport endpoint path
WEBTRANSPORT_PATH=/wt

# WebTransport stream and datagram limits
WEBTRANSPORT_MAX_STREAMS=1000
WEBTRANSPORT_MAX_DATAGRAM_SIZE=1200

# WebTransport reliability mode
# Options: reliable_ordered, reliable_unordered, unreliable_ordered, unreliable_unordered
WEBTRANSPORT_RELIABILITY=reliable_ordered

# WebTransport congestion control algorithm
WEBTRANSPORT_CONGESTION_CONTROL=bbr2

# Enable 0-RTT for WebTransport
WEBTRANSPORT_ENABLE_0RTT=true

# =============================================================================
# HTTP/3 AND QUIC CONFIGURATION
# =============================================================================

# Enable HTTP/3 protocol
HTTP3_ENABLED=false

# HTTP/3 port (typically 443 for production)
HTTP3_PORT=443

# QUIC version to use
HTTP3_QUIC_VERSION=draft-34

# HTTP/3 connection limits
HTTP3_MAX_CONNECTIONS=10000
HTTP3_CONNECTION_TIMEOUT=300

# 0-RTT and early data configuration
HTTP3_ENABLE_0RTT=true
HTTP3_ENABLE_EARLY_DATA=true

# Alt-Svc header max age (seconds)
HTTP3_ALT_SVC_MAX_AGE=3600

# Protocol negotiation and fallback
HTTP3_ENABLE_PROTOCOL_NEGOTIATION=true
HTTP3_FALLBACK_PROTOCOLS="h2,http/1.1"
HTTP3_PREFER_HTTP3=true
HTTP3_MIN_HTTP3_SCORE=150
HTTP3_ADAPTIVE_SELECTION=true

# =============================================================================
# BROADCASTING CONFIGURATION
# =============================================================================

# Default broadcasting driver
# Options: memory, redis, nats
REALTIME_BROADCAST_DRIVER=memory

# Memory broadcasting limits
REALTIME_MEMORY_MAX_CHANNELS=10000
REALTIME_MEMORY_MAX_SUBSCRIBERS=1000

# Redis broadcasting configuration
REALTIME_REDIS_HOST=localhost
REALTIME_REDIS_PORT=6379
REALTIME_REDIS_DATABASE=0
REALTIME_REDIS_PREFIX=highper:realtime:
REALTIME_REDIS_CLUSTER=false

# NATS broadcasting configuration
REALTIME_NATS_SERVERS=nats://localhost:4222
REALTIME_NATS_SUBJECT_PREFIX=highper.realtime

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Authentication settings
REALTIME_AUTH_ENABLED=false
REALTIME_AUTH_DRIVER=jwt

# JWT authentication configuration
REALTIME_JWT_SECRET=
REALTIME_JWT_ALGORITHM=HS256
REALTIME_JWT_VERIFY_SIGNATURE=true
REALTIME_JWT_VERIFY_EXPIRATION=true

# Rate limiting configuration
REALTIME_RATE_LIMIT_ENABLED=false
REALTIME_RATE_LIMIT_CONNECTIONS=10
REALTIME_RATE_LIMIT_MESSAGES=60
REALTIME_RATE_LIMIT_BURST=10

# CORS configuration
REALTIME_CORS_ENABLED=true
REALTIME_CORS_ORIGINS=*
REALTIME_CORS_METHODS="GET,POST"
REALTIME_CORS_HEADERS=*

# =============================================================================
# TELEMETRY AND OBSERVABILITY
# =============================================================================

# Zero-configuration telemetry (enables monitoring + tracing)
TELEMETRY_ENABLED=false

# Component-specific toggles (optional - auto-enabled when TELEMETRY_ENABLED=true)
MONITORING_ENABLED=false
TRACING_ENABLED=false

# Service identification
SERVICE_NAME=highper-realtime-app
SERVICE_VERSION=1.0.0

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================

# Monitoring sampling rate (0.0 to 1.0)
MONITORING_SAMPLING_RATE=0.1

# Enable specific monitoring features
MONITORING_TRACK_PERFORMANCE=true
MONITORING_TRACK_MEMORY=true
MONITORING_TRACK_DATABASE=true
MONITORING_TRACK_CACHE=true
MONITORING_TRACK_EXTERNAL_CALLS=true

# Security monitoring
MONITORING_SECURITY_ENABLED=true
MONITORING_TRACK_FAILED_AUTH=true
MONITORING_ANOMALY_DETECTION=true

# Performance thresholds
MONITORING_SLOW_REQUEST_MS=1000
MONITORING_HIGH_MEMORY_MB=128
MONITORING_HIGH_CPU_PERCENT=80

# =============================================================================
# TRACING CONFIGURATION
# =============================================================================

# Tracing sampling rate (0.0 to 1.0)
TRACING_SAMPLING_RATE=0.05

# OpenTelemetry settings
OTEL_SERVICE_NAME=highper-realtime-app
OTEL_SERVICE_VERSION=1.0.0
OTEL_TRACES_EXPORTER=jaeger

# Tracing features
TRACING_HTTP_ENABLED=true
TRACING_DATABASE_ENABLED=true
TRACING_CACHE_ENABLED=true
TRACING_EXTERNAL_ENABLED=true

# =============================================================================
# EXPORTERS CONFIGURATION
# =============================================================================

# Prometheus metrics export
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090
PROMETHEUS_ENDPOINT=/metrics

# Jaeger tracing export
TRACING_JAEGER_ENABLED=false
TRACING_JAEGER_AGENT_HOST=localhost
TRACING_JAEGER_AGENT_PORT=6832
TRACING_JAEGER_COLLECTOR_ENDPOINT=http://localhost:14268/api/traces

# =============================================================================
# HEALTH CHECK ENDPOINTS
# =============================================================================

# Health check endpoints (automatically available when telemetry enabled)
# /health/telemetry     - Overall telemetry health
# /health/monitoring    - Monitoring component health  
# /health/tracing       - Tracing component health
# /health/protocols     - Real-time protocol health
# /health/ready         - Kubernetes readiness probe
# /health/live          - Kubernetes liveness probe
# /metrics              - Prometheus metrics (if enabled)

# Legacy health check (for backward compatibility)
REALTIME_HEALTH_CHECK_ENABLED=true
REALTIME_HEALTH_CHECK_PATH=/realtime/health
REALTIME_HEALTH_CHECK_INCLUDE_METRICS=true

# =============================================================================
# PERFORMANCE AND OPTIMIZATION
# =============================================================================

# Memory and CPU optimization
REALTIME_MEMORY_LIMIT_MB=512
REALTIME_WORKER_PROCESSES=auto
REALTIME_ASYNC_WORKERS=4

# Compression integration
REALTIME_COMPRESSION_ENABLED=true
REALTIME_COMPRESSION_THRESHOLD=1024
REALTIME_COMPRESSION_ALGORITHM=gzip

# Connection pooling
REALTIME_CONNECTION_POOL_SIZE=100
REALTIME_CONNECTION_POOL_TIMEOUT=30

# =============================================================================
# DEVELOPMENT AND DEBUGGING
# =============================================================================

# Debug mode
REALTIME_DEBUG=false
REALTIME_LOG_LEVEL=info

# Protocol testing and development
REALTIME_ENABLE_PROTOCOL_TESTING=false
REALTIME_PROTOCOL_TEST_INTERVAL=60

# Performance monitoring
REALTIME_ENABLE_BENCHMARKING=false
REALTIME_BENCHMARK_INTERVAL=300

# =============================================================================
# INTEGRATION CONFIGURATION
# =============================================================================

# Framework integration
REALTIME_AUTO_REGISTER=true
REALTIME_SERVICE_PROVIDER_ENABLED=true

# Laravel integration
REALTIME_LARAVEL_ENABLED=false
REALTIME_LARAVEL_BROADCAST_DRIVER=redis

# Symfony integration
REALTIME_SYMFONY_ENABLED=false
REALTIME_SYMFONY_MESSENGER_ENABLED=false